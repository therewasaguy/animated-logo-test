<!doctype html>
<html>

	<head>
		<!-- <script src="http://cdnjs.cloudflare.com/ajax/libs/SVG-Morpheus/0.1.8/svg-morpheus.js"></script> -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.4.1/snap.svg.js"></script>
		<script src="http://cdn.tonejs.org/latest/Tone.min.js"></script>

		<style>
			svg {
				-webkit-user-select: none;
				 -moz-user-select: none;
				 -ms-user-select: none;
				 user-select: none;
				-webkit-tap-highlight-color: rgba(0,0,0,0);
			}
			svg::-moz-selection {
				background-color: transparent;
				color: #000;
			}
			svg::selection {
				background-color: transparent;
				color: #000;
			}
			svg:hover {
				cursor:pointer;
			}

		</style>
	</head>

	<body>
	<div style="width:300px">
		<svg id="shape-canvas" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 170.99 187.76">
		</svg>
	</div>

	<div style="display:none;">
		<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 170.99 187.76">
			<g id="shape-closed" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 170.99 187.76"><defs><style>.cls-1{fill:#fdbc2e;}.cls-2{fill:#dba02a;}.cls-3{fill:#b7852e;}.cls-4{fill:#6e7d2a;}</style></defs><title>msm_try2</title><path class="cls-1" d="M16.85,130.18A69.89,69.89,0,1,0,148.18,82.3Z"/><ellipse class="cls-2" cx="82.85" cy="106.27" rx="69.98" ry="15.98" transform="translate(-29.68 32.15) rotate(-18.69)"/><ellipse class="cls-3" cx="82.85" cy="106.27" rx="28.88" ry="6.6" transform="translate(-29.68 32.15) rotate(-18.69)"/><path class="cls-1" d="M16.85,130.18a69.89,69.89,0,0,0,89.6,41.73c36.27-13.22,55.72-52.23,42.5-88.5Z"/><path class="cls-4" d="M148.72,82.76A69.89,69.89,0,1,0,17.1,129.84Z"/>

			<g id="shape-open" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 170.99 187.76"><defs><style>.cls-1{fill:#fdbc2e;}.cls-2{fill:#dba02a;}.cls-3{fill:#b7852e;}.cls-4{fill:#6e7d2a;}</style></defs><title>msm_try2</title><path class="cls-1" d="M16.85,130.18A69.89,69.89,0,1,0,148.18,82.3Z"/><ellipse class="cls-2" cx="82.85" cy="106.27" rx="69.98" ry="15.98" transform="translate(-29.68 32.15) rotate(-18.69)"/><ellipse class="cls-3" cx="82.85" cy="106.27" rx="28.88" ry="6.6" transform="translate(-29.68 32.15) rotate(-18.69)"/><path class="cls-1" d="M16.85,130.18a69.89,69.89,0,0,0,89.6,41.73c36.27-13.22,55.72-52.23,42.5-88.5Z"/><path class="cls-4" d="M149.77,62.29A69.89,69.89,0,1,0,18.45,110.17Z"/></g>
		</svg>

<!-- 		<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 242.05 163.52">
			<g id="triangle-open" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 242.05 163.52"><defs><style>.cls-1{fill:none;}.cls-2{fill:#fdbc2e;}.cls-3{clip-path:url(#clip-path);}.cls-4{fill:#f99324;}</style><clipPath id="clip-path"><path class="cls-1" d="M181.91,10.91a27,27,0,0,0-43.43.1A108.68,108.68,0,1,0,181.91,10.91Z"/></clipPath></defs><title>msm-try2-triangle</title><polygon class="cls-2" points="82.4 4.81 0 163.52 160.23 163.52 82.4 4.81"/><g class="cls-3"><path class="cls-4" d="M166.38,0.54V-26.38a7.65,7.65,0,0,0-7.67-7.67A7.65,7.65,0,0,0,151-26.38V1.88a19.35,19.35,0,0,0-4.18,5L66.64,141.63c-6.61,11.11-.49,21.88,12.44,21.88H219.34a5.75,5.75,0,1,0,0-11.51H79.08c-4,0-4.6-1.05-2.55-4.49L156.74,12.77c2.12-3.57,3.69-3.56,5.83,0l66.31,111.4a5.75,5.75,0,1,0,9.89-5.89L172.46,6.91A18.2,18.2,0,0,0,166.38.54Z"/></g>

			<g  id="triangle-open" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 242.05 163.52"><defs><style>.cls-1{fill:none;}.cls-2{fill:#fdbc2e;}.cls-3{clip-path:url(#clip-path);}.cls-4{fill:#f99324;}</style><clipPath id="clip-path"><path class="cls-1" d="M136.91,9.21a27,27,0,0,0-43.43.1A108.68,108.68,0,1,0,136.91,9.21Z"/></clipPath></defs><title>msm-try2-triangle</title><polygon class="cls-2" points="114.4 3.12 32 161.82 192.23 161.82 114.4 3.12"/><g class="cls-3"><path class="cls-4" d="M121.38-1.16V-28.08a7.65,7.65,0,0,0-7.67-7.67A7.65,7.65,0,0,0,106-28.08V0.18a19.35,19.35,0,0,0-4.18,5L21.64,139.94C15,151,21.15,161.82,34.08,161.82H174.34a5.75,5.75,0,1,0,0-11.51H34.08c-4,0-4.6-1.05-2.55-4.49L111.74,11.07c2.12-3.57,3.69-3.56,5.83,0l66.31,111.4a5.75,5.75,0,1,0,9.89-5.89L127.46,5.22A18.2,18.2,0,0,0,121.38-1.16Z"/></g>
		</svg> -->

	</div>


	<script type="text/javascript">

	var shapeName = '#shape';

	var o, c;
	o = Snap(shapeName + '-open');
	c = Snap(shapeName + '-closed');

	// initialize by drawing first sprite to canvas
	var shapeCnv = Snap(shapeName + '-canvas');
	shapeCnv.add(o);
	shapeCnv = Snap(shapeCnv.node.children[2]); // hacky way to find actual elt

	var shifts = 0;
	var sprites = [c.clone(), o.clone()];

	sprites.forEach(function(s) {
		s.node.setAttribute('style', 'display:none;');
	});

	document.getElementById('shape-canvas').addEventListener('click', function() {
		animateElt(10);
		setTimeout(animateElt, 100);
		snd.triggerAttackRelease();
	});


	function animateElt(_duration) {
			var duration = _duration || 500;
			var closedShapes = sprites[shifts%sprites.length].children();

			var i = 0;
			shapeCnv.children().forEach( function(elt){
				var props = closedShapes[i].attr();

				var className = props.class;
				// do not copy these props
				delete props.class;
				delete props.width;
				// console.log(className);
				elt.animate(props,duration, mina.bounce);
				// elt.node.setAttribute('class', className);
				i++;
			});
			// prep to do it again
			shifts++;
	}

	var snd = new Tone.Sampler('audio/banana-shaker_test_01.mp3');
	snd.toMaster();

	</script>

	</body>

</html>